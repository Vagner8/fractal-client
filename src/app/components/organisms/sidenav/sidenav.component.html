@let showModifiersTaps = ss.$showModifiersTaps();
@let selectedFractal = fs.selectedFractal.$value();
@let backButton = fs.$app()?.findChildRecursively('Back button');

<mat-drawer-container class="mat-drawer-container-app-sidenav" autosize>
  <mat-drawer
    [opened]="ss.$managerEvent() === 'touch'"
    [disableClose]="false"
    class="mat-drawer-app-sidenav"
    mode="side"
    position="end">
    <div>
      @if (showModifiersTaps && modifiers) {
        @for (cursor of modifiers.getStringsData('Children'); track $index) {
          @if (modifiers.findChild([cursor]); as child) {
            <app-tap
              [$fractal]="child"
              (hold)="showModifiersTaps ? onModifierHold(child) : onHold(child)"
              (touch)="showModifiersTaps ? onModifierTouch(child) : onTouch(child)"/>
          }
        }
      } @else {
        @if (selectedFractal) {
          @for (cursor of selectedFractal.getStringsData('Children'); track $index) {
            @let child = selectedFractal.findChild([cursor]);
            @if (child && child.findControl('Children')) {
              <app-tap
                [$fractal]="child"
                (hold)="showModifiersTaps ? onModifierHold(child) : onHold(child)"
                (touch)="showModifiersTaps ? onModifierTouch(child) : onTouch(child)"/>
            }
          }
        }
      }
      @if (!showModifiersTaps && selectedFractal?.parent; as parent) {
        <app-tap [$title]="backButton?.getStringData('Name')" [$fractal]="backButton" (touch)="onTouch(parent)"/>
      }
    </div>
  </mat-drawer>
  <router-outlet />
</mat-drawer-container>
